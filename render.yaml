services:
  # Backend API Service
  - type: web
    name: medical-records-backend
    env: go
    region: oregon
    plan: free
    buildCommand: cd backend && go mod download && go build -o ../bin/server ./cmd/server
    startCommand: ./bin/server
    envVars:
      # Database connection - Create PostgreSQL database manually in Render Dashboard first
      # Then add these environment variables in the service settings:
      # - DB_HOST (from your PostgreSQL service)
      # - DB_PORT (from your PostgreSQL service)
      # - DB_USER (from your PostgreSQL service)
      # - DB_PASSWORD (from your PostgreSQL service)
      # - DB_NAME (database name, e.g., medical_records)
      # - DB_SSLMODE=require
      - key: DB_SSLMODE
        value: require
      - key: SERVER_PORT
        value: 8080
      - key: JWT_SECRET
        generateValue: true
      - key: JWT_EXPIRATION_HOURS
        value: 24
      - key: APP_ENV
        value: production
      - key: APP_DEBUG
        value: false

  # Frontend Service
  - type: static
    name: medical-records-frontend
    region: oregon
    buildCommand: cd frontend && npm install && npm run build
    staticPublishPath: ./frontend/build
    envVars:
      - key: REACT_APP_API_URL
        value: https://medical-records-backend.onrender.com/api/v1

